<!-- templates/components/sidebar.html -->
<div th:fragment="sidebar">
    <!-- Overlay móvil -->
    <div class="sidebar-backdrop" onclick="closeSidebar()" tabindex="-1"></div>

    <!-- Sidebar -->
    <aside id="appSidebar" class="app-sidebar" aria-label="Menú lateral" role="navigation">
        <header class="sidebar-header">
            <span class="brand">
                <strong class="brand-full">IoT&nbsp;Admin</strong>
                <strong class="brand-compact" aria-hidden="true">IA</strong>
            </span>

            <!-- Toggle desktop/móvil -->
            <button type="button" class="sidebar-toggle"
                    aria-label="Colapsar/expandir menú"
                    aria-controls="appSidebar"
                    aria-pressed="false"
                    onclick="toggleSidebar()">☰</button>
        </header>

        <!-- Navegación: usa variable 'nav' enviada por controlador -->
        <nav class="sidebar-nav" th:with="currentNav=${nav} ?: ''">
            <ul>
                <li>
                    <a th:href="@{/dashboard}" th:classappend="${currentNav == 'dashboard'} ? ' active'">
                        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill="currentColor" d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                        </svg>
                        <span class="link-label">Dashboard</span>
                    </a>
                </li>
                <li>
                    <a th:href="@{/plantillas}" th:classappend="${currentNav == 'plantillas'} ? ' active'">
                        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill="currentColor" d="M14 2H6a2 2 0 0 0-2 2v14l4-2 4 2 4-2 4 2V8zM6 4h7v4H6z"/>
                        </svg>
                        <span class="link-label">Plantillas</span>
                    </a>
                </li>
                <li>
                    <a th:href="@{/dispositivos}" th:classappend="${currentNav == 'dispositivos'} ? ' active'">
                        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill="currentColor" d="M12 20a2 2 0 0 1-2-2h4a2 2 0 0 1-2 2zm6-6v-3a6 6 0 0 0-12 0v3l-2 2v1h16v-1l-2-2zM12 4a4 4 0 0 1 4 4v3H8V8a4 4 0 0 1 4-4z"/>
                        </svg>
                        <span class="link-label">Dispositivos</span>
                    </a>
                </li>
                <li>
                    <a th:href="@{/telemetria}" th:classappend="${currentNav == 'telemetria'} ? ' active'">
                        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill="currentColor" d="M3 3v18h18v-2H5V3H3zm16 4-4 7-3-3-4 6h14l-3-10z"/>
                        </svg>
                        <span class="link-label">Telemetría</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Footer con control de tema -->
        <div class="sidebar-footer p-3">
            <button id="themeToggle" class="btn btn-outline-light w-100" type="button" aria-pressed="false" aria-label="Alternar tema">
                <i class="bi bi-sun-fill me-2" aria-hidden="true"></i>
                <span class="theme-label">Modo Claro</span>
            </button>
        </div>
    </aside>

    <!-- Botón flotante móvil para abrir menu -->
    <button class="sidebar-fab" type="button" onclick="toggleSidebar()" aria-label="Abrir menú lateral">
        <i class="bi bi-list" aria-hidden="true"></i>
    </button>
</div>
